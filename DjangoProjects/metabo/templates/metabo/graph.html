{% extends "metabo/home.html" %}

{% block title %}
    computecyto
{% endblock %}

{% block style %}
{% endblock %}

{% load static %}

{% block content %}



    <script src="{% static "metabo/cytoscape.umd.js" %}"></script>
    {#        <scripts src= {% static "metabo/d3.js" %}></scripts>#}
    {#        <scripts src="https://d3js.org/d3.v4.min.js"></scripts>#}

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    {#    <scripts src= {% static "metabo/init.json" %}></scripts>#}


    <div id="cy"></div>
    <h1 style="text-align: center">bitoku </h1>
    {#    <style>#cy {#}
    {#        width: 100%;#}
    {#        height: 100%;#}
    {#        position: absolute;#}
    {#        top: 0px;#}
    {#        left: 0px;#}
    {#    }</style>#}

    <form id="jsonFile" name="jsonFile" enctype="multipart/form-data" method="post">
        <fieldset>
            <h2>Json File</h2>
            <input type='file' id='fileinput'>
            <input type='button' id='btnLoad' value='Load' onclick='loadFile();'>
            <input type="button" id="btnsave" value="Save" onclick="saveFile();">
        </fieldset>
    </form>
    <script>


        let data = {{ ll }};
    </script>

    <script type="text/javascript">
        var path = "/Users/maximelecomte/Github/MbiGlog/DjangoProjects/metabo/templates/metabo"
        var da = [
            {
                "data": {
                    "id": "a",
                    "label": "Gene1"
                }
            },
            {
                "data": {
                    "id": "b",
                    "label": "Gene2"
                }
            },
            {
                "data": {
                    "id": "ab",
                    "source": "a",
                    "target": "b"
                }
            }
        ];
        {#var fs = require('/Users/maximelecomte/Github/MbiGlog/DjangoProjects/metabo/templates/metabo/init.json');#}
        {#const test = fs.readFileSync('/Users/maximelecomte/Github/MbiGlog/DjangoProjects/metabo/templates/metabo/init.json', 'utf8');#}
        const test = '[{"data":{"id":"a","label":"Gene1"}},{"data":{"id":"b","label":"Gene2"}},{"data":{"id":"ab","source":"a","target":"b"}}]';
        const obj = JSON.parse(test);

        var cy = cytoscape(
            {
                container: document.getElementById('cy'),
                elements: obj,
                style: [ // the stylesheet for the graph
                    {
                        selector: 'node',
                        style: {
                            'background-color': '#666',
                            'label': 'data(id)'
                        }
                    },

                    {
                        selector: 'edge',
                        style: {
                            'width': 3,
                            'line-color': '#ccc',
                            'target-arrow-color': '#ccc',
                            'target-arrow-shape': 'triangle'
                        }
                    }
                ],

                layout:
                    {
                        name: 'grid'
                    }
            });

        cy.layout({
            name: 'circle'
        }).run();


        function loadFile() {
            var input, file, fr;

            if (typeof window.FileReader !== 'function') {
                alert("The file API isn't supported on this browser yet.");
                return;
            }

            input = document.getElementById('fileinput');
            if (!input) {
                alert("Um, couldn't find the fileinput element.");
            } else if (!input.files) {
                alert("This browser doesn't seem to support the `files` property of file inputs.");
            } else if (!input.files[0]) {
                alert("Please select a file before clicking 'Load'");
            } else {
                file = input.files[0];
                fr = new FileReader();
                fr.onload = receivedText;
                fr.readAsText(file);
            }

            function receivedText(e) {
                let lines = e.target.result;
                var newArr = JSON.parse(lines);
                console.log(newArr);
                return newArr;
            }

            {
            }
        }

        function saveFile() {
            var file = document.getElementById();
        }


        {#var eles = cy.add([#}
        {#    {group: 'nodes', data: {id: 'n0'}, position: {x: 100, y: 100}},#}
        {#    {group: 'nodes', data: {id: 'n1'}, position: {x: 200, y: 200}},#}
        {#    {group: 'edges', data: {id: 'e0', source: 'n0', target: 'n1'}}#}
        {#]);#}

    </script>



{% endblock %}
